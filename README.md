# doccano
doccano æ˜¯ä¸€ä¸ªå¼€æºçš„æ–‡æœ¬æ ‡æ³¨å·¥å…·ï¼Œç”¨äºäººå·¥æ ‡æ³¨ã€‚å®ƒæä¾›äº†ç”¨äºæ–‡æœ¬åˆ†ç±»ã€åºåˆ—æ ‡æ³¨å’Œåºåˆ—åˆ°åºåˆ—ä»»åŠ¡çš„æ ‡æ³¨åŠŸèƒ½ã€‚ç”¨æˆ·å¯ä»¥åˆ›å»ºå¸¦æœ‰æƒ…æ„Ÿåˆ†æã€å‘½åå®ä½“è¯†åˆ«ã€æ–‡æœ¬æ‘˜è¦ç­‰æ ‡ç­¾çš„æ•°æ®ã€‚åªéœ€åˆ›å»ºä¸€ä¸ªé¡¹ç›®ã€ä¸Šä¼ æ•°æ®ï¼Œç„¶åå¼€å§‹è¿›è¡Œæ ‡æ³¨ã€‚ç”¨æˆ·å¯ä»¥åœ¨å‡ å°æ—¶å†…æ„å»ºä¸€ä¸ªæ•°æ®é›†ã€‚<br>

doccanoçš„githubé“¾æ¥å¦‚ä¸‹:<br>

```txt
https://github.com/doccano/doccano
```

doccanoã€Šä½¿ç”¨æ‰‹å†Œã€‹é“¾æ¥å¦‚ä¸‹:<br>

```txt
https://doccano.github.io/doccano/
```

- [doccano](#doccano)
  - [å¯åŠ¨doccano:](#å¯åŠ¨doccano)
    - [doccanoç‰¹ç‚¹ï¼š](#doccanoç‰¹ç‚¹)
    - [doccanoçš„pythonè¦æ±‚ï¼š](#doccanoçš„pythonè¦æ±‚)
    - [doccanoå®‰è£…å¹¶å¯åŠ¨ï¼š](#doccanoå®‰è£…å¹¶å¯åŠ¨)
  - [ç½‘é¡µç™»å½•:](#ç½‘é¡µç™»å½•)
  - [åˆ›å»ºé¡¹ç›®:](#åˆ›å»ºé¡¹ç›®)
  - [å¯¼å…¥æ•°æ®é›†:](#å¯¼å…¥æ•°æ®é›†)
  - [å»ºç«‹æ ‡ç­¾å’Œå…³ç³»:](#å»ºç«‹æ ‡ç­¾å’Œå…³ç³»)
  - [æ ‡æ³¨æ•°æ®:](#æ ‡æ³¨æ•°æ®)
  - [å¯¼å‡ºæ–‡ä»¶ï¼š](#å¯¼å‡ºæ–‡ä»¶)
  - [ä»£ç è¯»å–jsonlæ–‡ä»¶ï¼Œæ„å»ºä¸‰å…ƒç»„:](#ä»£ç è¯»å–jsonlæ–‡ä»¶æ„å»ºä¸‰å…ƒç»„)
    - [ä¸Neo4jéœ€è¦çš„æ•°æ®æ ¼å¼è”åŠ¨çš„pythonä»£ç ç¤ºä¾‹:](#ä¸neo4jéœ€è¦çš„æ•°æ®æ ¼å¼è”åŠ¨çš„pythonä»£ç ç¤ºä¾‹)
  - [å¤šäººåä½œ:](#å¤šäººåä½œ)
  - [ä»»åŠ¡åˆ†é…:](#ä»»åŠ¡åˆ†é…)

## å¯åŠ¨doccano:

### doccanoç‰¹ç‚¹ï¼š
- Collaborative annotationï¼ˆåä½œæ ‡æ³¨ï¼‰
- Multi-language supportï¼ˆå¤šè¯­è¨€æ”¯æŒï¼‰
- Mobile supportï¼ˆç§»åŠ¨ç«¯æ”¯æŒï¼‰
- Emoji ğŸ˜„ supportï¼ˆè¡¨æƒ…ç¬¦å·æ”¯æŒï¼‰
- Dark themeï¼ˆæš—é»‘ä¸»é¢˜ï¼‰
- RESTful API

### doccanoçš„pythonè¦æ±‚ï¼š

pip (Python 3.8+)<br>

### doccanoå®‰è£…å¹¶å¯åŠ¨ï¼š

å‡è®¾ä½ ä½¿ç”¨çš„condaï¼Œå¯é€šè¿‡ä»¥ä¸‹æŒ‡ä»¤åˆ›å»ºåä¸ºdoccanoçš„è™šæ‹Ÿç¯å¢ƒï¼Œå¹¶å®‰è£…æœ€æ–°ç‰ˆpythonã€‚<br>

```bash
# åˆ›å»ºåä¸ºdoccanoçš„è™šæ‹Ÿç¯å¢ƒï¼Œå¹¶å®‰è£…æœ€æ–°ç‰ˆpython
conda create -n doccano python
```

å¦‚æœè¦ä½¿ç”¨æŒ‡å®šç‰ˆæœ¬çš„pythonï¼Œå¯ä½¿ç”¨ä»¥ä¸‹æŒ‡ä»¤:<br>

```bash
conda create -n doccano python=3.10.11
```

æ¿€æ´»è™šæ‹Ÿç¯å¢ƒ:<br>

```bash
conda activate doccano
```

ä»¥pipçš„æ–¹å¼å®‰è£…doccano:<br>

```shell
pip install doccano
```

å¦‚æœä½ ä½¿ç”¨ `pip install doccano` æŒ‡ä»¤åœ¨å®‰è£…doccanoæ—¶æŠ¥äº†å¦‚ä¸‹é”™è¯¯ï¼š<br>

```shell
Preparing metadata (setup.py) ... error
error: subprocess-exited-with-error
```

è¿è¡Œä»¥ä¸‹æŒ‡ä»¤å³å¯ï¼š<br>

```shell
pip install setuptools-scm
pip install doccano
```

å®‰è£…åï¼Œç»ˆç«¯è¿è¡Œä»¥ä¸‹å‘½ä»¤ï¼š<br>

```shell
# Initialize database.(åˆå§‹åŒ–æ•°æ®åº“)
doccano init
# Create a super user.(åˆ›å»ºä¸€ä¸ªè¶…çº§ç®¡ç†å‘˜ï¼Œ"admin"å’Œ"pass"ä¿®æ”¹ä¸ºè‡ªå·±çš„è´¦æˆ·åå’Œå¯†ç ï¼Œä¹Ÿå¯ä»¥ä¸ä¿®æ”¹ç›´æ¥ä½¿ç”¨ä¸‹åˆ—æŒ‡ä»¤ã€‚)
doccano createuser --username admin --password pass
# Start a web server.(å¯åŠ¨ç«¯å£å·ä¸º8000çš„webæœåŠ¡)
doccano webserver --port 8000
```

å¦‚æœç«¯å£å·8000å’Œä½ ç³»ç»Ÿçš„ç«¯å£å·äº§ç”Ÿäº†å†²çªï¼Œå¯ä»¥ç›´æ¥é€šè¿‡ç±»ä¼¼ä»¥ä¸‹æŒ‡ä»¤ä¿®æ”¹ç«¯å£ï¼Œå†æ¬¡å¯åŠ¨doccano:<br>

```bash
doccano webserver --port 8008
```

ğŸš¨ğŸš¨ğŸš¨å¦å¼€ä¸€ä¸ªç»ˆç«¯ï¼Œè¿è¡Œä¸‹åˆ—æŒ‡ä»¤ã€‚åªæœ‰è¿è¡Œäº†ä¸‹åˆ—æŒ‡ä»¤doccanoæ‰æ”¯æŒæ–‡ä»¶çš„ä¸Šä¼ å’Œä¸‹è½½ï¼š<br>

```shell
# Start the task queue to handle file upload/download.
doccano task
```

å¦‚æœæ‰§è¡Œ `doccano task` æ˜¾ç¤º `pydantic:ConstrainedStr has been removed in V2`ï¼Œå°† `pydantic` é™çº§åˆ°1.8ç‰ˆæœ¬å°±å¥½äº†ã€‚<br>


## ç½‘é¡µç™»å½•:

è¿è¡Œ `doccano webserver --port 8000` åç»ˆç«¯ä¼šæç¤ºä½ doccanoçš„è®¿é—®é“¾æ¥ï¼Œä¾‹å¦‚:<br>

```txt
http://127.0.0.1:8000/
```

å¦‚æœä½ æ˜¯æœåŠ¡å™¨å¯åŠ¨çš„doccanoï¼Œè®¿é—®æ–¹å¼ä¸º `http://{your_public_ip}:8000/` ï¼Œä¾‹å¦‚:<br>

```txt
http://8.140.203.xxx:8000
```

ğŸš¨ğŸš¨ğŸš¨æ³¨æ„ï¼šæœåŠ¡å™¨å¯åŠ¨çš„doccanoä¸€å®šè¦å¼€å¯å¯¹åº”çš„å…¬ç½‘ç«¯å£ï¼Œå¦åˆ™æ— æ³•è®¿é—®å¯åŠ¨çš„æœåŠ¡ã€‚<br>

æµè§ˆå™¨è¾“å…¥ä¸Šè¿°ç½‘å€åï¼Œä½ åº”è¯¥å·²ç»è¿›å…¥äº†doccanoçš„ä¸»é¡µã€‚æ­¤æ—¶ç‚¹å‡»ç•Œé¢å³ä¸Šè§’çš„ "Log in" ï¼Œç„¶åè¾“å…¥è´¦å·å’Œå¯†ç å³å¯ç™»å½•ã€‚<br>

å¦‚æœä½ æ˜¯ä½¿ç”¨ `doccano createuser --username admin --password pass` åˆ›å»ºçš„è´¦å·å’Œå¯†ç ï¼Œåˆ™è´¦å·ä¸º `admin` ï¼Œå¯†ç ä¸º `pass` ã€‚<br>


## åˆ›å»ºé¡¹ç›®:

ä»¥NERä»»åŠ¡ä¸ºä¾‹ï¼Œåˆ›å»ºé¡¹ç›®çš„å…·ä½“æµç¨‹å¦‚ä¸‹:<br>

1. Project ç•Œé¢ç‚¹å‡» "Create" æŒ‰é’®ï¼›

2. é€‰æ‹© "Sequence Labeling"ï¼Œå³åºåˆ—æ ‡æ³¨ï¼›

3. è¾“å…¥ "Project name"ã€"Description"ã€"Tags"ï¼Œæ³¨æ„ "Tags" çš„åˆ†å‰²æ–¹å¼åï¼Œè¾“å…¥å†…å®¹åå›è½¦å³ç»„æˆä¸€ä¸ªTagï¼Œç„¶åç»§ç»­è¾“å…¥å†…å®¹ï¼Œå†æ¬¡å›è½¦ï¼Œä¼šæ·»åŠ ä¸€ä¸ªæ–°çš„Tagï¼›

4. è‡ªå·±å†³å®šæ˜¯å¦å‹¾é€‰ "Allow project members to create label types"ï¼Œå³å…è®¸å›¢é˜Ÿæˆå‘˜åˆ›å»ºæ ‡ç­¾ï¼›

5. å‹¾é€‰ "Allow overlapping spans"ï¼Œå³å…è®¸é‡å ï¼›

![](./docs/allow_overlapping_spans.jpg)

6. å‹¾é€‰ "use relation labeling"ï¼Œå³ä½¿ç”¨å…³ç³»æ ‡è®°ï¼›

7. è‡ªå·±å†³å®šæ˜¯å¦å‹¾é€‰ "count grapheme clusters as one character"ï¼ˆå°†ä¸åŒè¯­è¨€çš„æœ€å°è¯­è¨€å•ä½è®¡ä¸ºä¸€ä¸ªå­—ç¬¦ï¼‰ï¼Œå¤„ç†å¤åˆè¯­è¨€ä¼šç”¨åˆ°ã€‚å¦‚æœä½ çš„é¡¹ç›®ä¸æ¶‰åŠä½¿ç”¨å¤åˆå­—ç¬¦çš„è¯­è¨€ï¼ˆå¦‚æŸäº›å°åº¦è¯­ç³»è¯­è¨€ã€æ³°è¯­ç­‰ï¼‰ï¼Œæˆ–è€…ä¸éœ€è¦ç‰¹åˆ«å…³æ³¨å¦‚è¡¨æƒ…ç¬¦å·è¿™æ ·çš„ç‰¹æ®Šå­—ç¬¦è¡¨ç¤ºï¼Œä½ å¯èƒ½ä¸éœ€è¦å‹¾é€‰è¿™ä¸ªé€‰é¡¹ã€‚

8. è‡ªå·±å†³å®šæ˜¯å¦å‹¾é€‰ "Randomize document order"ï¼Œå³æ–‡æ¡£éšæœºæ’åºï¼›

9. è‡ªå·±å†³å®šæ˜¯å¦å‹¾é€‰ "Share annotations across all users"ï¼Œå³åœ¨æ‰€æœ‰ç”¨æˆ·å…±äº«æ ‡æ³¨ã€‚<br>

"åœ¨æ‰€æœ‰ç”¨æˆ·å…±äº«æ ‡æ³¨":<br>

- **å‹¾é€‰â€œåœ¨æ‰€æœ‰ç”¨æˆ·å…±äº«æ ‡æ³¨â€**ï¼šè¿™æ„å‘³ç€é¡¹ç›®ä¸­çš„æ‰€æœ‰æ ‡æ³¨å‘˜å¯ä»¥çœ‹åˆ°å…¶ä»–äººçš„æ ‡æ³¨ç»“æœã€‚è¿™ä¸ªé€‰é¡¹å¯¹äºä¸€äº›ç‰¹å®šçš„åº”ç”¨åœºæ™¯æ˜¯æœ‰ç”¨çš„ï¼Œæ¯”å¦‚å½“æ‚¨éœ€è¦å¤šä¸ªæ ‡æ³¨å‘˜å¯¹åŒä¸€æ•°æ®é›†è¿›è¡Œå®¡æŸ¥æˆ–è€…éœ€è¦ä»–ä»¬åœ¨å½¼æ­¤çš„å·¥ä½œåŸºç¡€ä¸Šè¿›è¡Œè¿›ä¸€æ­¥çš„æ ‡æ³¨æ—¶ã€‚è¿™æœ‰åŠ©äºä¿æŒæ ‡æ³¨ç»“æœçš„ä¸€è‡´æ€§ï¼Œå¹¶å¯ä»¥ä½œä¸ºè´¨é‡æ§åˆ¶çš„ä¸€ç§å½¢å¼ï¼Œè®©æ ‡æ³¨å‘˜ä¹‹é—´èƒ½å¤ŸéªŒè¯å’Œæ”¹è¿›å½¼æ­¤çš„æ ‡æ³¨ã€‚

- **ä¸å‹¾é€‰â€œåœ¨æ‰€æœ‰ç”¨æˆ·å…±äº«æ ‡æ³¨â€**ï¼šè¿™æ„å‘³ç€æ¯ä¸ªæ ‡æ³¨å‘˜åªèƒ½çœ‹åˆ°å¹¶æ ‡æ³¨è‡ªå·±çš„ä»»åŠ¡åˆ†é…ï¼Œçœ‹ä¸åˆ°å…¶ä»–æ ‡æ³¨å‘˜çš„æ ‡æ³¨ç»“æœã€‚è¿™é€‚ç”¨äºæ‚¨å¸Œæœ›ç‹¬ç«‹æ”¶é›†å¤šä¸ªæ ‡æ³¨å‘˜å¯¹åŒä¸€æ•°æ®é›†çš„æ ‡æ³¨ç»“æœï¼Œä»¥ä¾¿ä¹‹åæ¯”è¾ƒå’Œåˆå¹¶è¿™äº›ç»“æœï¼Œæˆ–è€…åœ¨æ ‡æ³¨ä»»åŠ¡éœ€è¦ä¿æŒç‹¬ç«‹æ€§å’Œç›²å®¡çš„æƒ…å¢ƒä¸‹ã€‚

ç¬”è€…æ˜¯è¿™å‡ é¡¹å…¨éƒ¨å‹¾é€‰çš„ï¼Œå›¾ç¤ºå¦‚ä¸‹:<br>

![](./docs/click_all_options.jpg)

10. ç‚¹å‡» "create" åˆ›å»ºé¡¹ç›®ã€‚

æ­¤æ—¶é¡¹ç›®å·²ç»åˆ›å»ºæˆåŠŸäº†ï¼Œä½ å¯ä»¥å¼€å§‹å¯¼å…¥æ•°æ®é›†äº†ã€‚<br>


## å¯¼å…¥æ•°æ®é›†:

åœ¨å¯¼å…¥æ•°æ®é›†ä¹‹å‰ï¼Œå…ˆç¡®ä¿ä½ å·²ç»å¼€å¯äº†doccanoçš„æ–‡ä»¶ä¸Šä¼ ä¸ä¸‹è½½åŠŸèƒ½ï¼Œå³å¦å¼€äº†ä¸€ä¸ªç»ˆç«¯è¿è¡Œ `doccano task`ã€‚<br>

doccanoçš„æ–‡ä»¶ä¸Šä¼ ä¸ä¸‹è½½åŠŸèƒ½å¼€å¯åï¼Œç‚¹å‡»å·¦ä¾§èœå•æ çš„ "Dataset" ï¼Œç„¶åç‚¹å‡» "Actions"ï¼Œé€‰æ‹© "Import Dataset"ã€‚<br>

doccanoæ”¯æŒå¤šç§æ•°æ®å¯¼å…¥æ–¹å¼ï¼Œç¬”è€…æ¨èçš„æ˜¯ **"TextLine"** æ–¹å¼ã€‚<br>

![](./docs/import_dataset.jpg)

ä¸Šä¼ çš„æ–‡ä»¶æ ¼å¼ä¾æ—§ä¸ºtxtï¼Œä½†è¦æ³¨æ„å†…å®¹ä¸ºæ¯ä¸€æ¡æ•°æ®å æ®ä¸€è¡Œï¼Œä¾‹å¦‚:<br>

```txt
ã€Šæˆ˜äº‰ä¸å’Œå¹³ã€‹æ˜¯æ‰˜å°”æ–¯æ³°çš„æ°ä½œä¹‹ä¸€ã€‚
ã€ŠæŒ‡ç¯ç‹ã€‹ç³»åˆ—ç”±å½¼å¾—Â·æ°å…‹é€Šå¯¼æ¼”ã€‚
é’¢é“ä¾ æ˜¯æ¼«å¨å®‡å®™ä¸­çš„ä¸€ä¸ªè¶…çº§è‹±é›„ã€‚
ä¼Šä¸½èç™½äºŒä¸–æ˜¯è‹±å›½çš„å¥³ç‹ã€‚
```

ä¸Šä¼ å®Œæˆåï¼Œç‚¹å‡» "Import" å³å¯ï¼Œdoccanoä¼šå¸®ä½ è‡ªåŠ¨æŒ‰è¡Œåˆ†å‰²æ•°æ®ï¼Œæ•ˆæœå¦‚ä¸‹:<br>

> å›¾ç‰‡ä¸­æ•°æ®çš„é¡ºåºæ˜¯éšæœºçš„ï¼Œè¿™æ˜¯å› ä¸ºç¬”è€…åœ¨åˆ›å»ºé¡¹ç›®æ—¶å‹¾é€‰äº† "Randomize document order"ï¼Œå³æ–‡æ¡£éšæœºæ’åºï¼›

![](./docs/split_doc.jpg)


## å»ºç«‹æ ‡ç­¾å’Œå…³ç³»:

ğŸš¨ğŸš¨ğŸš¨å£°æ˜:ç”±äºdoccanoæœ¬èº«çš„ç¼˜æ•…ï¼Œå·¦ä¾§èœå•æ çš„ "Relations" æŒ‰é’®ç‚¹å‡»ä¼šæŠ¥é”™ã€‚è¿™ä¸ªå¹¶ä¸å½±å“doccanoæœ¬èº«çš„ä½¿ç”¨ï¼Œå› ä¸º "Relation" åŠŸèƒ½è¢«åŒ…å«åœ¨äº† "Labels" æ¨¡å—ä¸­ã€‚<br>

![](./docs/click_relations.jpg)

åˆ›å»ºlabelså’Œrelationså¾ˆç®€å•ï¼Œæ²¡ä»€ä¹ˆå¯è®²çš„ï¼Œå…·ä½“å¯å‚è€ƒä¸‹å›¾:<br>

![](./docs/create_labels_and_relations.jpg)


## æ ‡æ³¨æ•°æ®:

æ ‡ç­¾å’Œå…³ç³»åˆ›å»ºå¥½åï¼Œç‚¹å‡» "Dataset" è¿”å›æ•°æ®é›†ç•Œé¢ã€‚é€‰æ‹©ä½ è¦æ ‡æ³¨çš„æ•°æ®ï¼Œç‚¹å‡» "Annotate"(æ ‡æ³¨) å³å¯å¼€å§‹æ ‡æ³¨æ•°æ®ã€‚å…·ä½“æ ‡æ³¨æ–¹å¼å¯å‚è€ƒä¸‹å›¾:<br>

![](./docs/annotate_progress.jpg)

æ³¨æ„: å½“ç‚¹å‡»æ ‡ç­¾æˆ–å…³ç³»åï¼Œæ¯æ¬¡é€‰ä¸­å†…å®¹ä¼šè‡ªåŠ¨æ‰§è¡Œæ ‡æ³¨æ“ä½œï¼Œä¸å†æœ‰é€‰é¡¹ã€‚ç›¸å½“äºå¿«é€Ÿæ ‡æ³¨ï¼Œç¤ºæ„å›¾å¦‚ä¸‹:<br>

![](./docs/fast_annotate.jpg)

æ•°æ®æ ‡æ³¨å¥½åï¼Œå¯å‚è€ƒä¸‹å›¾æ“ä½œï¼ŒåŒºåˆ† "å®Œæˆ" ä¸ "è¿›è¡Œä¸­" çš„ä»»åŠ¡:<br>

![](./docs/status_translate.jpg)


## å¯¼å‡ºæ–‡ä»¶ï¼š

doccano å¯¼å‡ºçš„ JSONL æ–‡ä»¶ä¸­ï¼Œæ¯ä¸ªå®ä½“å’Œå…³ç³»éƒ½æœ‰ä¸€ä¸ªç‹¬ç‰¹çš„ id ä½œä¸ºæ ‡è¯†ç¬¦ã€‚è¿™äº› id æ˜¯ç”± doccano åœ¨æ ‡æ³¨æ•°æ®çš„è¿‡ç¨‹ä¸­è‡ªåŠ¨ç”Ÿæˆçš„ï¼Œ**å®ƒä»¬ä¸ä¸€å®šæŒ‰ç…§é¡ºåºæ’åˆ—æˆ–è€…æ˜¯è¿ç»­çš„**ã€‚å› æ­¤ï¼Œä½ çœ‹åˆ°çš„idå¯èƒ½ä¼šå‡ºç°ä¹±åºçš„æƒ…å†µï¼Œè¿™å¹¶ä¸å½±å“æ•°æ®çš„æ­£ç¡®æ€§å’Œä½¿ç”¨ã€‚<br>

é€‰æ‹©éœ€è¦çš„æ•°æ®ï¼Œç„¶åç‚¹å‡» "Export Dataset"ï¼Œ"File format" é€‰æ‹© "JSONL" (æš‚æ—¶doccanoåªæä¾›äº†JSONLè¿™ä¸€ç§å¯¼å‡ºæ–¹å¼)ï¼Œçœ‹ä¸ªäººéœ€æ±‚å‹¾é€‰ "Export only approved documents" ï¼Œç„¶åç‚¹å‡» "Export" å³å¯å°†æ–‡ä»¶ä¸‹è½½åˆ°æœ¬åœ°(zipæ ¼å¼ï¼Œéœ€è¦è§£å‹):<br>

![](./docs/export_dataset.jpg)

å‹¾é€‰ "Export only approved documents" (ä»…å¯¼å‡ºå·²å®¡æ ¸çš„æ–‡æ¡£)ï¼Œæ•ˆæœå¦‚ä¸‹:<br>

```jsonl
{"id":12,"text":"ã€ŠæŒ‡ç¯ç‹ã€‹ç³»åˆ—ç”±å½¼å¾—Â·æ°å…‹é€Šå¯¼æ¼”ã€‚","entities":[{"id":29,"label":"äººå","start_offset":8,"end_offset":14},{"id":30,"label":"ä¹¦å","start_offset":0,"end_offset":5}],"relations":[{"id":15,"from_id":30,"to_id":29,"type":"ä½œè€…"}],"Comments":[]}
{"id":14,"text":"ä¼Šä¸½èç™½äºŒä¸–æ˜¯è‹±å›½çš„å¥³ç‹ã€‚","entities":[{"id":31,"label":"äººå","start_offset":0,"end_offset":6},{"id":32,"label":"åœ°å","start_offset":7,"end_offset":9}],"relations":[],"Comments":[]}
```

ä¸å‹¾é€‰ "Export only approved documents" (ä»…å¯¼å‡ºå·²å®¡æ ¸çš„æ–‡æ¡£)ï¼Œæ•ˆæœå¦‚ä¸‹:<br>

```jsonl
{"id":11,"text":"ã€Šæˆ˜äº‰ä¸å’Œå¹³ã€‹æ˜¯æ‰˜å°”æ–¯æ³°çš„æ°ä½œä¹‹ä¸€ã€‚","entities":[],"relations":[],"Comments":[]}
{"id":12,"text":"ã€ŠæŒ‡ç¯ç‹ã€‹ç³»åˆ—ç”±å½¼å¾—Â·æ°å…‹é€Šå¯¼æ¼”ã€‚","entities":[{"id":29,"label":"äººå","start_offset":8,"end_offset":14},{"id":30,"label":"ä¹¦å","start_offset":0,"end_offset":5}],"relations":[{"id":15,"from_id":30,"to_id":29,"type":"ä½œè€…"}],"Comments":[]}
{"id":13,"text":"é’¢é“ä¾ æ˜¯æ¼«å¨å®‡å®™ä¸­çš„ä¸€ä¸ªè¶…çº§è‹±é›„ã€‚","entities":[],"relations":[],"Comments":[]}
{"id":14,"text":"ä¼Šä¸½èç™½äºŒä¸–æ˜¯è‹±å›½çš„å¥³ç‹ã€‚","entities":[{"id":31,"label":"äººå","start_offset":0,"end_offset":6},{"id":32,"label":"åœ°å","start_offset":7,"end_offset":9}],"relations":[],"Comments":[]}
```

## ä»£ç è¯»å–jsonlæ–‡ä»¶ï¼Œæ„å»ºä¸‰å…ƒç»„:

ç°åœ¨æˆ‘ä»¬å·²ç»å¾—åˆ°äº†æ ‡æ³¨å¥½çš„æ•°æ®ï¼Œå¯æ‰§è¡Œä¸‹åˆ—ä»£ç ï¼Œè¯»å–jsonlæ–‡ä»¶ï¼Œå¹¶æ„å»ºä¸‰å…ƒç»„ã€‚<br>

```python
import json

def extract_triples_from_jsonl(file_path):
    # åˆå§‹åŒ–ä¸‰å…ƒç»„åˆ—è¡¨
    triples = []
    
    # æ‰“å¼€æ–‡ä»¶å¹¶æŒ‰è¡Œè¯»å–
    with open(file_path, 'r', encoding='utf-8') as file:
        for line in file:
            # è§£ææ¯è¡Œçš„JSONæ•°æ®
            item = json.loads(line)
            
            # æ„å»ºå®ä½“IDåˆ°å®ä½“çš„æ˜ å°„
            entities = {entity['id']: entity for entity in item['entities']}
            
            # éå†å…³ç³»ï¼Œæ„å»ºä¸‰å…ƒç»„ã€‚å¦‚æœæ²¡æœ‰å…³ç³»ï¼Œåˆ™ä¸æå–ä¿¡æ¯ã€‚
            for relation in item['relations']:
                from_entity = entities[relation['from_id']]
                to_entity = entities[relation['to_id']]
                triples.append({
                    'text': item['text'],
                    'subject': item['text'][from_entity['start_offset']:from_entity['end_offset']],
                    'predicate': relation['type'],
                    'object': item['text'][to_entity['start_offset']:to_entity['end_offset']]
                })
                
    # è¿”å›æå–çš„ä¸‰å…ƒç»„åˆ—è¡¨
    return triples

if __name__ == "__main__":
    # æ–‡ä»¶è·¯å¾„
    file_path = "data.jsonl"
    triples = extract_triples_from_jsonl(file_path)

    # æ‰“å°æå–çš„ä¸‰å…ƒç»„
    for triple in triples:
        print(triple)
```

ç»ˆç«¯æ˜¾ç¤º:<br>

```txt
{'text': 'ã€ŠæŒ‡ç¯ç‹ã€‹ç³»åˆ—ç”±å½¼å¾—Â·æ°å…‹é€Šå¯¼æ¼”ã€‚', 'subject': 'ã€ŠæŒ‡ç¯ç‹ã€‹', 'predicate': 'ä½œè€…', 'object': 'å½¼å¾—Â·æ°å…‹é€Š'}
```

### ä¸Neo4jéœ€è¦çš„æ•°æ®æ ¼å¼è”åŠ¨çš„pythonä»£ç ç¤ºä¾‹:

ä¸Šè¿°çš„ä¾‹å­è¿‡äºç®€å•ï¼Œå¦‚æœæ•°æ®å¤æ‚ï¼Œæˆ‘ä»¬éœ€è¦å°†jsonlæ–‡ä»¶ä¸­çš„å†…å®¹è¿›è¡Œæ•´ç†ï¼Œè¿™æ ·æ‰å¯ä»¥æ–¹ä¾¿å­˜å…¥neo4jã€‚è¿™é‡Œæä¾›ç¬”è€…ç”¨çš„æ•´ç†ä»£ç :<br>

```python
"""
Author: peilongchencc@163.com
Description: å°†doccanoè¾“å‡ºçš„jsonlæ–‡ä»¶æ•´ç†ä¸ºæ–¹ä¾¿å†™å…¥neo4jçš„æ ¼å¼,å¹¶å­˜å…¥æ–°çš„jsonæ–‡ä»¶ã€‚
Requirements: 
Reference Link:
Notes: è¾“å‡ºçš„æ–‡ä»¶æ ¼å¼è¯¦æƒ…å¯ä»¥å‚è€ƒç¬”è€…`Neo4j/python_sdk_of_neo4j`ç« èŠ‚çš„å†…å®¹ã€‚
"""
import json

def extract_triples_from_jsonl(file_path):
    """å°†doccanoè¾“å‡ºçš„jsonlæ–‡ä»¶æ•´ç†ä¸ºæ–¹ä¾¿å†™å…¥neo4jçš„æ ¼å¼ã€‚
    Args:
        file_path: doccanoè¾“å‡ºçš„jsonlçš„æ–‡ä»¶è·¯å¾„ã€‚
    Return:
        processed_data:æ•´ç†åçš„ä¸‰å…ƒç»„å­—å…¸,æ¯ä¸€ä¸ªå…ƒç´ (`triplet_x`)ä¸ºä¸€ä¸ªä¸‰å…ƒç»„åˆ—è¡¨,åˆ—è¡¨ä¸­å«æœ‰ä¸‰ä¸ªå­—å…¸,åˆ†åˆ«æ˜¯å®ä½“Aã€å®ä½“Bã€å…³ç³»çš„æ‰€æœ‰ä¿¡æ¯ã€‚
    """
    # åˆå§‹åŒ–ä¸‰å…ƒç»„å­—å…¸
    processed_data = {}
    triplet_counter = 1
    # æ‰“å¼€æ–‡ä»¶å¹¶æŒ‰è¡Œè¯»å–
    with open(file_path, "r", encoding="utf-8") as file:
        for line in file:
            # è§£ææ¯è¡Œçš„JSONæ•°æ®
            item = json.loads(line)
            
            # æ„å»ºå®ä½“IDåˆ°å®ä½“çš„æ˜ å°„
            entities = {entity["id"]: entity for entity in item["entities"]}
            
            # éå†å…³ç³»ï¼Œæ„å»ºä¸‰å…ƒç»„ã€‚å¦‚æœæ²¡æœ‰å…³ç³»ï¼Œåˆ™ä¸æå–ä¿¡æ¯ã€‚
            for relation in item["relations"]:
                triples = []
                from_entity = entities[relation["from_id"]]
                to_entity = entities[relation["to_id"]]
                # å®ä½“Açš„ä¿¡æ¯
                triples.append({
                    # "text": item["text"],
                    "entity_type": from_entity["label"],
                    "properties": {
                        "name": item["text"][from_entity["start_offset"]:from_entity["end_offset"]]
                    }})
                # å®ä½“Bçš„ä¿¡æ¯
                triples.append({
                        "entity_type": to_entity["label"],
                        "properties": {
                        "name": item["text"][to_entity["start_offset"]:to_entity["end_offset"]]
                        
                    }})
                # å…³ç³»ä¿¡æ¯
                triples.append({"relationship": relation["type"]})
                processed_data[f"triplet_{triplet_counter}"] = triples
                triplet_counter += 1
                
    # è¿”å›æå–çš„ä¸‰å…ƒç»„å­—å…¸
    return processed_data


if __name__ == "__main__":
    # æ–‡ä»¶è·¯å¾„
    file_path = "doccano_output.jsonl"
    # å°†doccanoè¾“å‡ºçš„jsonlæ–‡ä»¶æ•´ç†ä¸ºæ–¹ä¾¿å†™å…¥neo4jçš„æ ¼å¼ã€‚
    triples = extract_triples_from_jsonl(file_path)
    # print(len(triples))
    # å°†æ•´ç†åçš„æ•°æ®æ ¼å¼å†™å…¥æ–°æ–‡ä»¶(json)
    with open("doccano_output_clean.json", "w", encoding="utf-8") as new_file:
        json.dump(triples, new_file, ensure_ascii=False, indent=4)
```

`doccano_output_clean.json`çš„æ•°æ®æ ¼å¼ç±»ä¼¼å¦‚ä¸‹å†…å®¹:<br>

```python
data = {
    "triplet_1": [
        {
            "entity_type": "Person",    # å®ä½“çš„ç±»å‹
            "properties": {
                "name": "Jerry",        # å®ä½“çš„å±æ€§
                "age": 30
                }
            },
        {
            "entity_type": "Person",    # å®ä½“çš„ç±»å‹
            "properties": {
                "name": "Tom",          # å®ä½“çš„å±æ€§
                "age": 28
                }
            },
        {
            "relationship": "Catch",    # å…³ç³»çš„ç±»å‹
            "properties": {
                "time": "2024-2-12"     # å…³ç³»çš„å±æ€§
                }
            }
        ],
    "triplet_2": [
        {
            "entity_type": "Person",    # å®ä½“çš„ç±»å‹
            "properties": {
                "name": "Jerry",        # å®ä½“çš„å±æ€§
                "age": 30
                }
            },
        {
            "entity_type": "Person",    # å®ä½“çš„ç±»å‹
            "properties": {
                "name": "Tom",          # å®ä½“çš„å±æ€§
                "age": 28
                }
            },
        {
            "relationship": "Catch",    # å…³ç³»çš„ç±»å‹
            "properties": {
                "time": "2024-2-12"     # å…³ç³»çš„å±æ€§
                }
            }
        ]
    }
```

ç”±äºç¬”è€…ä½¿ç”¨çš„æ•°æ®ä¸­å…³ç³»æ²¡æœ‰å±æ€§ï¼Œæ•…ç¬”è€…çš„pythonä»£ç å°±æ²¡æœ‰å†™è¿™éƒ¨åˆ†ã€‚å¤§å®¶æ ¹æ®è‡ªå·±çš„æƒ…å†µï¼Œå‚è€ƒä»£ç ä½¿ç”¨å³å¯ã€‚<br>

## å¤šäººåä½œ:

å¦‚æœæƒ³è¦è¿›è¡Œå¤šäººåä½œï¼Œå…±åŒæ ‡æ³¨ï¼Œæ“ä½œæ­¥éª¤å¦‚ä¸‹:<br>

1. ç™»å½•ç®¡ç†å‘˜ç«™ç‚¹ï¼Œç½‘å€ä¸º `http://localhost:{port}/admin/` ï¼Œå¦‚æœä½ æ˜¯æœåŠ¡å™¨å¯åŠ¨çš„æœåŠ¡ï¼Œåˆ™ç½‘å€ç±»ä¼¼:

```txt
http://8.140.203.xxx:8000/admin/
```

2. "AUTHENTICATION AND AUTHORIZATION" æ¨¡å—ä¸‹ï¼Œç‚¹å‡» "Users"ï¼Œç„¶åç‚¹å‡»å³ä¸Šè§’çš„ "ADD USER"ï¼›

3. è¾“å…¥ "Username" å’Œ "Password"ï¼Œä¾‹å¦‚ï¼š

```txt
Username:peilongchencc
Password:Flameaway3.
```

4. ç‚¹å‡» "SAVE"ï¼Œç„¶åå¼€å§‹é…ç½®æƒé™:

![](./docs/set_permissions.jpg)

5. æƒé™è®¾ç½®æˆåŠŸåç‚¹å‡» "SAVE"ï¼Œå³å¯çœ‹åˆ°ä»¥ä¸‹ç•Œé¢:

![](./docs/user_info.jpg)

6. å…³é—­ç®¡ç†å‘˜ç«™ç‚¹ï¼Œåˆ·æ–°doccanoä¸»é¡µï¼Œæ‰¾åˆ°ä½ çš„é¡¹ç›®ï¼Œç‚¹å‡» "Members"ï¼›

7. ç‚¹å‡» "Add" ï¼Œæ‹‰å–ç”¨æˆ·åˆ°å½“å‰é¡¹ç›®ï¼Œå¹¶è®¾ç½®ç”¨æˆ·è§’è‰²ã€‚ç‚¹å‡» "Save"ï¼›

![](./docs/set_role.jpg)

ç°åœ¨æ–°ç”¨æˆ·å·²ç»æ‹‰åˆ°ä½ æŒ‡å®šçš„é¡¹ç›®ä¸­äº†ï¼Œä»–å¯ä»¥å’Œä½ åä½œæ ‡æ³¨äº†ã€‚<br>

ğŸš¨ğŸš¨ğŸš¨æ³¨æ„: doccano ä¸æ”¯æŒå®æ—¶æ˜¾ç¤ºï¼Œå³ä½ å’ŒåŒäº‹åŒæ—¶æ“ä½œæŸä¸€ä¸ªæ–‡ä»¶æ—¶ï¼Œæ— æ³•çœ‹åˆ°å¯¹æ–¹æ ‡æ³¨çš„å†…å®¹ï¼Œéœ€è¦åˆ·æ–°ç•Œé¢æ‰å¯ä»¥çœ‹åˆ°ã€‚æ‰€ä»¥ï¼Œå»ºè®®å·¥ä½œäººå‘˜å•†é‡å¥½ï¼Œæ¯ä¸ªäººè´Ÿè´£çš„éƒ¨åˆ†ï¼Œé¿å…é‡å¤æ ‡æ³¨å¼•å‘é”™è¯¯ã€‚<br>


## ä»»åŠ¡åˆ†é…:

doccanoä¸æ”¯æŒä¸ºåœ¨åŒä¸€ä¸ªé¡¹ç›®ä¸­ä¸ºä¸åŒç”¨æˆ·åˆ†é…ä¸åŒæ•°æ®é›†ï¼Œè¿™æ˜¯å› ä¸ºDoccanoçš„é¡¹ç›®ç®¡ç†æ˜¯åŸºäºé¡¹ç›®çº§åˆ«çš„ï¼Œè€Œä¸æ˜¯æ•°æ®é›†çº§åˆ«çš„ã€‚å¯é€šè¿‡åˆ›å»ºä¸åŒé¡¹ç›®ï¼Œä¸ºä¸åŒé¡¹ç›®æ‹‰å–ä¸åŒæˆå‘˜å®ç°ä»»åŠ¡åˆ†é…(ä¸åŒé¡¹ç›®ä¸Šä¼ ä¸åŒæ•°æ®é›†)ã€‚<br>

